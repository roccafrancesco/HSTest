      SUBROUTINE TP85(MODE)     
      IMPLICIT DOUBLEPRECISION (A-H,O-Z)  
      INTEGER    MODE,NMAX,MMAX,N,NILI,NINL,NELI,NENL,NEX   
      DOUBLEPRECISION X,G,GF,GG,FX,XL,XU,FEX,XEX 
      LOGICAL    INDEX1,INDEX2,LXL,LXU,LEX    
      PARAMETER (NMAX=101, MMAX=50)
      COMMON     /L1/  N,NILI,NINL,NELI,NENL 
     /           /L2/  X(NMAX)                              
     /           /L3/  G(MMAX)           
     /           /L4/  GF(NMAX)          
     /           /L5/  GG(MMAX,NMAX)        
     /           /L6/  FX
     /           /L9/  INDEX1(MMAX)     
     /           /L10/ INDEX2(MMAX)
     /           /L11/ LXL(NMAX)       
     /           /L12/ LXU(NMAX)    
     /           /L13/ XL(NMAX)     
     /           /L14/ XU(NMAX)    
     /           /L20/ LEX,NEX,FEX,XEX(NMAX) 
      INTEGER I,J
      COMMON     /D85/C(17),Y(17),DC(17,5),DY(17,5),A(17),B(17)  
      DOUBLEPRECISION C,Y,DC,DY,A,B,V1,V2,V3,V4,V5,V6,V7
      IF (MODE - 2) 1,17,17     
1     N=5       
      NILI=3    
      NINL=35   
      NELI=0    
      NENL=0    
      X(1)=900.D0       
      X(2)=80.D0
      X(3)=115.D0       
      X(4)=267.D0       
      X(5)=27.D0
      DO 6 I=1,5
      LXL(I)=.TRUE.     
6     LXU(I)=.TRUE.     
      XL(1)=704.4148D0  
      XL(2)=68.6D0      
      XL(3)=0.D0
      XL(4)=193.D0      
      XL(5)=25.D0       
      XU(1)=906.3855D0  
      XU(2)=288.88D0    
      XU(3)=134.75D0    
      XU(4)=287.0966D0  
      XU(5)=84.1988D0   
      A(2)=17.505D0     
      A(3)=11.275D0     
      A(4)=214.228D0    
      A(5)=7.458D0      
      A(6)=0.961D0      
      A(7)=1.612D0      
      A(8)=0.146D0      
      A(9)=107.99D0     
      A(10)=922.693D0   
      A(11)=926.832D0   
      A(12)=18.766D0    
      A(13)=1.072163D+3 
      A(14)=8.961448D+3 
      A(15)=0.063D0     
      A(16)=7.108433D+4 
      A(17)=2.802713D+6 
      B(2)=1.0536667D+3 
      B(3)=35.03D0      
      B(4)=665.585D0    
      B(5)=584.463D0    
      B(6)=265.916D0    
      B(7)=7.046D0      
      B(8)=0.222D0      
      B(9)=273.366D0    
      B(10)=1.286105D+3 
      B(11)=1.444046D+3 
      B(12)=537.141D0   
      B(13)=3.247039D+3 
      B(14)=2.6844086D+4
      B(15)=0.386D0     
      B(16)=1.4D+5      
      B(17)=1.2146108D+7
      DO 61 I=1,5       
      GG(1,I)=0.D0      
      GG(2,I)=0.D0      
      GG(3,I)=0.D0      
      DC(1,I)=0.D0      
      DC(5,I)=0.D0      
      DC(10,I)=0.D0     
61    CONTINUE  
      GG(1,2)=1.5D0     
      GG(1,3)=-1.D0     
      GG(2,2)=1.D0      
      GG(2,3)=1.D0      
      GG(3,2)=-1.D0     
      GG(3,3)=-1.D0     
      DY(1,1)=0.D0      
      DY(1,2)=1.D0      
      DY(1,3)=1.D0      
      DY(1,4)=0.D0      
      DY(1,5)=0.D0      
      DC(1,4)=0.024D0   
      DC(5,2)=100.D0    
      LEX=.FALSE.       
      NEX=1
      XEX(1)=0.705180328772D+03     
      XEX(2)=0.686000529425D+02     
      XEX(3)=0.102900013236D+03     
      XEX(4)=0.282324998587D+03     
      XEX(5)=0.375850413432D+02     
      FEX=-0.19051553D+01
      RETURN    
17    Y(1)=X(2)+X(3)+41.6D0     
      C(1)=0.024D0*X(4)-4.62D0  
      Y(2)=12.5D0/C(1)+12.0D0   
      V3=Y(2)*X(1)      
      C(2)=(3.535D-4*X(1)+0.5311D0)*X(1)+0.08705D0*V3   
      C(3)=0.052D0*X(1)+78.D0+2.377D-3*V3       
      Y(3)=C(2)/C(3)    
      Y(4)=19.D0*Y(3)   
      V1=X(1)-Y(3)      
      C(4)=(0.1956D0*V1/X(2)+0.04782D0)*V1+0.6376D0*Y(4)+1.594D0*Y(3)  
      C(5)=100.D0*X(2)  
      C(6)=V1-Y(4)      
      C(7)=0.95D0-C(4)/C(5)     
      Y(5)=C(6)*C(7)    
      V2=Y(5)+Y(4)      
      Y(6)=V1-V2
      C(8)=0.995D0*V2   
      Y(7)=C(8)/Y(1)    
      Y(8)=C(8)/3.798D+3
      C(9)=Y(7)-0.0663D0*Y(7)/Y(8)-0.3153D0     
      Y(9)=96.82D0/C(9)+0.321D0*Y(1)    
      Y(10)=1.29D0*Y(5)+1.258D0*Y(4)+2.29D0*Y(3)+1.71D0*Y(6)    
      Y(11)=1.71D0*X(1)-0.452D0*Y(4)+0.58D0*Y(3)
      C(10)=12.3D0/752.3D0      
      C(11)=1.74125D0*V3
      C(12)=0.995D0*Y(10)+1.998D+3      
      Y(12)=C(10)*X(1)+C(11)/C(12)      
      Y(13)=C(12)-1.75D0*Y(2)   
      V4=Y(9)+X(5)      
      Y(14)=3.623D+3+64.4D0*X(2)+58.4D0*X(3)+1.46312D+5/V4      
      C(13)=0.995D0*Y(10)+60.8D0*X(2)+48.D0*X(4)-0.1121D0*Y(14) 
     /      -5.095D+3 
      Y(15)=Y(13)/C(13) 
      Y(16)=1.48D+5-3.31D+5*Y(15)+40.D0*Y(13)-61.D0*Y(15)*Y(13)
      C(14)=2.324D+3*Y(10)-2.874D+7*Y(2)
      Y(17)=1.413D+7-1.328D+3*Y(10)-531.D0*Y(11)+C(14)/C(12) 
      C(15)=Y(13)/Y(15)-Y(13)/0.52D0    
      C(16)=1.104D0-0.72D0*Y(15)
      C(17)=V4  
      IF (MODE.EQ.3.OR.MODE.EQ.5) GOTO 71       
      GOTO (1,2,3,4,5),MODE     
71    DO 30 I=1,5       
30    DY(2,I)=-12.5D0*DC(1,I)/C(1)**2   
      V5=Y(2)+X(1)*DY(2,1)      
      DC(2,1)=7.07D-4*X(1)+0.5311D0+0.08705D0*V5
      DC(3,1)=0.052D0+2.377D-3*V5       
      DO 32 I=2,5       
      V6=X(1)*DY(2,I)   
      DC(2,I)=0.08705D0*V6      
32    DC(3,I)=2.377D-3*V6       
      DO 33 I=1,5       
      DY(3,I)=(C(3)*DC(2,I)-C(2)*DC(3,I))/C(3)**2       
33    DY(4,I)=19.D0*DY(3,I)     
      DC(4,1)=(0.04782D0+0.3912D0*V1/X(2))*(1.D0-DY(3,1))+      
     -0.6376D0*DY(4,1)  
     -+1.594D0*DY(3,1)  
      DC(4,2)=-0.1956D0*V1*(V1+2.D0*X(2)*DY(3,2))/X(2)**2+1     
     -.54618D0  
     -*DY(3,2)+0.6376D0*DY(4,2) 
      DO 34 I=3,5       
34    DC(4,I)=(1.54618D0-0.3912D0*V1/X(2))*DY(3,I)+0.6376D0*D   
     -Y(4,I)    
      DC(6,1)=1.D0-DY(3,1)-DY(4,1)      
      DO 35 I=2,5       
35    DC(6,I)=-DY(3,I)-DY(4,I)  
      DO 36 I=1,5       
      DC(7,I)=-(C(5)*DC(4,I)-C(4)*DC(5,I))/C(5)**2      
36    DY(5,I)=C(6)*DC(7,I)+C(7)*DC(6,I) 
      DO 37 I=1,5       
37    DY(6,I)=-DY(5,I)-DY(4,I)-DY(3,I)  
      DY(6,1)=DY(6,1)+1.D0      
      DO 38 I=1,5       
      DC(8,I)=0.995D0*(DY(5,I)+DY(4,I)) 
      DY(7,I)=(Y(1)*DC(8,I)-C(8)*DY(1,I))/Y(1)**2       
      DY(8,I)=DC(8,I)/3.798D+3  
      DC(9,I)=DY(7,I)-0.0663D0*(Y(8)*DY(7,I)-Y(7)*DY(8,I)       
     -)/Y(8)**2 
      DY(9,I)=-96.82D0*DC(9,I)/C(9)**2+0.321D0*DY(1,I)  
38    DY(10,I)=1.29D0*DY(5,I)+1.258D0*DY(4,I)+2.29D0*DY(3,I)+   
     -1.71D0*DY(6,I)    
      DY(11,1)=1.71D0-0.452D0*DY(4,1)+0.58D0*DY(3,1)    
      DO 39 I=2,5       
39    DY(11,I)=-0.452D0*DY(4,I)+0.58D0*DY(3,I)  
      DC(11,1)=1.74125D0*(Y(2)+X(1)*DY(2,1))    
      DO 40 I=2,5       
40    DC(11,I)=1.74125D0*X(1)*DY(2,I)   
      DO 41 I=1,5       
41    DC(12,I)=0.995D0*DY(10,I) 
      DY(12,1)=C(10)+X(1)*DC(10,1)+(C(12)*DC(11,1)-C(11 
     -)*DC(12,1))/C(12) 
     -**2       
      DO 42 I=2,5       
42    DY(12,I)=(C(12)*DC(11,I)-C(11)*DC(12,I))/C(12)**2 
      DO 43 I=1,5       
43    DY(13,I)=DC(12,I)-1.75D0*DY(2,I)  
      V7=-1.46312D+5/V4**2      
      DY(14,1)=V7*DY(9,1)       
      DY(14,2)=64.4D0+V7*DY(9,2)
      DY(14,3)=58.4D0+V7*DY(9,3)
      DY(14,4)=V7*DY(9,4)       
      DY(14,5)=V7*(1.D0+DY(9,5))
      DO 44 I=1,5       
44    DC(13,I)=0.995D0*DY(10,I)-0.1121D0*DY(14,I)       
      DC(13,2)=DC(13,2)+60.8D0  
      DC(13,4)=DC(13,4)+48.D0   
      DO 45 I=1,5       
      DY(15,I)=(C(13)*DY(13,I)-Y(13)*DC(13,I))/C(13)**2 
      DY(16,I)=-3.31D+5*DY(15,I)+40.D0*DY(13,I)-61.D0*(Y(15)    
     -*DY(13,I)+Y(13)*  
     -DY(15,I)) 
      DC(14,I)=2.324D+3*DY(10,I)-2.874D+7*DY(2,I)       
      DY(17,I)=-1.328D+3*DY(10,I)-531.D0*DY(11,I)+(C(12)*D      
     -C(14,I)-C(14)     
     -*DC(12,I))/C(12)**2       
      DC(15,I)=(Y(15)*DY(13,I)-Y(13)*DY(15,I))/Y(15)**2 
     --DY(13,I)/0.52D0  
45    DC(16,I)=-0.72D0*DY(15,I) 
      DO 46 I=1,4       
46    DC(17,I)=DY(9,I)  
      DC(17,5)=DY(9,5)+1.D0     
      GOTO (1,2,3,4,5),MODE     
2     FX = -(5.843D-7*Y(17) - 1.17D-4*Y(14) - 0.1365D0 
     /      - 2.358D-5*Y(13) - 1.502D-6*Y(16) - 0.0321D0*Y(12)
     /      - 4.324D-3*Y(5) - 1.D-4*C(15)/C(16) - 37.48D0*Y(2)/C(12))
      RETURN    
3     DO 47 I=1,5       
      GF(I)=-5.843D-7*DY(17,I)+1.17D-4*DY(14,I)+2.358D-5*DY(13,I)
     /   + 1.502D-6*DY(16,I)+0.0321D0*DY(12,I)+4.324D-3*DY(5,I)
     /   + 1.D-4*(C(16)*DC(15,I)-C(15)*DC(16,I))/C(16)**2
     /   + 37.48D0*(C(12)*DY(2,I)-Y(2)*DC(12,I))/C(12)**2       
47    CONTINUE  
      RETURN    
4     IF (INDEX1(1)) G(1)=1.5D0*X(2)-X(3)       
      IF (INDEX1(2)) G(2)=Y(1)-213.1D0  
      IF (INDEX1(3)) G(3)=405.23D0-Y(1) 
      DO 50 I=1,16      
      IF (INDEX1(I+3)) G(I+3)=Y(I+1)-A(I+1)     
      IF (INDEX1(I+19)) G(I+19)=B(I+1)-Y(I+1)   
50    CONTINUE  
      IF (INDEX1(36)) G(36)=Y(4)-0.28D0*Y(5)/0.72D0     
      IF (INDEX1(37)) G(37)=21.0D0-3.496D+3*Y(2)/C(12)  
      IF (INDEX1(38)) G(38)=6.2212D+4/C(17)-110.6D0-Y(1)
      RETURN    
5     DO 54 I=1,16      
      IF (.NOT.INDEX2(I+3)) GOTO 52     
      DO 51 J=1,5       
51    GG(I+3,J)=DY(I+1,J)       
52    IF (.NOT.INDEX2(I+19)) GOTO 54    
      DO 53 J=1,5       
53    GG(I+19,J)=-DY(I+1,J)     
54    CONTINUE  
      IF (.NOT.INDEX2(36)) GOTO 56      
      DO 55 J=1,5       
55    GG(36,J)=DY(4,J)-0.28D0*DY(5,J)/0.72D0    
56    IF (.NOT.INDEX2(37)) GOTO 58      
      DO 57 J=1,5       
57    GG(37,J)=-3.496D+3*(C(12)*DY(2,J)-Y(2)*DC(12,J))/C(12)**2   
58    IF (.NOT.INDEX2(38)) GOTO 60      
      DO 59 J=1,5       
59    GG(38,J)=-6.2212D+4*DC(17,J)/C(17)**2-DY(1,J)     
60    RETURN    
      END       
