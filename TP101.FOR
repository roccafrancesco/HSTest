      SUBROUTINE TP101(MODE)    
      IMPLICIT DOUBLEPRECISION (A-H,O-Z)  
      INTEGER    MODE,NMAX,MMAX,N,NILI,NINL,NELI,NENL,NEX   
      DOUBLEPRECISION X,G,GF,GG,FX,XL,XU,FEX,XEX 
      LOGICAL    INDEX1,INDEX2,LXL,LXU,LEX    
      PARAMETER (NMAX=101, MMAX=50)
      COMMON     /L1/  N,NILI,NINL,NELI,NENL 
     /           /L2/  X(NMAX)                              
     /           /L3/  G(MMAX)           
     /           /L4/  GF(NMAX)          
     /           /L5/  GG(MMAX,NMAX)        
     /           /L6/  FX
     /           /L9/  INDEX1(MMAX)     
     /           /L10/ INDEX2(MMAX)
     /           /L11/ LXL(NMAX)       
     /           /L12/ LXU(NMAX)    
     /           /L13/ XL(NMAX)     
     /           /L14/ XU(NMAX)    
     /           /L20/ LEX,NEX,FEX,XEX(NMAX) 
      COMMON     /D101/ A(3),GV(7),FMIN(3)      
      DOUBLEPRECISION A,GV,FMIN,SUM,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,
     /     V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25, 
     /     V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37,V38, 
     /     V39,V40,V41,V42,V43,V44,V45
      INTEGER I,KN1,K,M
      KN1=1     
      LEX=.FALSE.       
      NEX=1
      XEX(1)=0.285615855584D+01     
      XEX(2)=0.610823030755D+00     
      XEX(3)=0.215081256203D+01     
      XEX(4)=0.471287370945D+01     
      XEX(5)=0.999487540961D+00     
      XEX(6)=0.134750750498D+01     
      XEX(7)=0.316527664991D-01     
      FEX=0.180976476556D+04 
      GOTO 13   
      ENTRY TP102(MODE) 
      KN1=2     
      LEX=.FALSE.       
      NEX=1
      XEX(1)=0.389625319099D+01     
      XEX(2)=0.809358760118D+00     
      XEX(3)=0.266438599373D+01     
      XEX(4)=0.430091287458D+01     
      XEX(5)=0.853554935267D+00     
      XEX(6)=0.109528744459D+01     
      XEX(7)=0.273104596581D-01     
      FEX=0.911880571336D+03 
      GOTO 13   
      ENTRY TP103(MODE) 
      KN1=3     
      LEX=.FALSE.       
      NEX=1
      XEX(1)=0.439410451026D+01     
      XEX(2)=0.854468738817D+00     
      XEX(3)=0.284323031380D+01     
      XEX(4)=0.339997866779D+01     
      XEX(5)=0.722926133025D+00     
      XEX(6)=0.870406381840D+00     
      XEX(7)=0.246388263302D-01     
      FEX=0.543667958424D+03 
   13 CONTINUE 
      M=KN1      
      GOTO (1,2,3,4,5),MODE     
    1 N=7       
      A(1)=-0.25D0      
      A(2)=0.125D0      
      A(3)=0.5D0
      NILI=0    
      NINL=6    
      NELI=0    
      NENL=0    
      DO 6 I=1,7
      X(I)=6.D0 
      XL(I)=0.1D0       
      XU(I)=10.D0       
      LXL(I)=.TRUE.     
6     LXU(I)=.TRUE.     
      XL(7)=0.01D0      
      GG(1,5)=0.D0      
      GG(2,7)=0.D0      
      GG(3,4)=0.D0      
      GG(4,6)=0.D0      
      RETURN    
2     DO 200 K=1,7      
200   IF (X(K).LT..0D-8) GOTO 14 
      FX=10.D0*X(1)*X(4)**2*X(7)**A(M)/(X(2)*X(6)**3)
     /    +15.D0*X(3)*X(4)/(X(1)*X(2)**2*X(5)*X(7)**0.5D0)
     /    +20.D0*X(2)*X(6)/(X(1)**2*X(4)*X(5)**2)
     /    +25.D0*X(1)**2*X(2)**2*X(5)**0.5D0*X(7)/(X(3)*X(6)**2)    
      RETURN    
14    SUM=0.D0  
      DO 40 I=1,7       
40    SUM=SUM+(X(I)-5.D0)**2    
      FMIN(1)=1.8D+3    
      FMIN(2)=9.1D+2    
      FMIN(3)=5.4D+2    
      FX=SUM+1.D+3+FMIN(KN1)    
      RETURN    
3     DO 201 K=1,7      
201   IF (X(K).LT.1.0D-8) GOTO 15 
      V1=10.D0*X(4)**2  
      V2=X(7)**A(M)     
      V3=X(2)*X(6)**3   
      V4=15.D0*X(3)*X(4)
      V5=X(1)*X(2)**2*X(5)*X(7)**0.5D0  
      V6=20.D0*X(2)*X(6)
      V7=X(1)**2*X(4)*X(5)**2   
      V8=25.D0*X(1)*X(2)*X(5)**0.5D0*X(7)       
      V9=X(3)*X(6)**2   
      V10=12.5D0*X(1)**2*X(2)**2*X(7)   
      V11=X(5)**0.5D0   
      GF(1)=V1*V2/V3-V4/(X(1)*V5)-2.D0*V6/(X(1)*V7)+2.D0*X(2)*V8/V9  
      GF(2)=-V1*X(1)*V2/(X(2)*V3)-2.D0*V4/(X(2)*V5)+20.D0*X(6)/V7
     /      +2.D0*X(1)*V8/V9       
      GF(3)=15.D0*X(4)/V5-X(1)*X(2)*V8/(X(3)*V9)
      GF(4)=20.D0*X(1)*X(4)*V2/V3+15.D0*X(3)/V5-V6/(X(4)*V7) 
      GF(5)=-V4/(X(5)*V5)-2.D0*V6/(X(5)*V7)+V10/(V9*V11)
      GF(6)=-3.D0*V1*X(1)*V2/(X(6)*V3)+20.D0*X(2)/V7-4.D0*V10   
     /        *V11/(X(6)*V9)    
      GF(7)=A(M)*V1*X(1)*X(7)**(A(M)-1.D0)/V3-0.5D0*V4/(V5*     
     /        X(7))+V8*X(1)*X(2)/(X(7)*V9)       
      RETURN    
15    DO 50 I=1,7       
50    GF(I)=2.D0*(X(I)-5.D0)    
      RETURN    
4     DO K=1,7      
         IF (X(K).LT.1.0D-8) GOTO 16 
      ENDDO   
      IF (INDEX1(1)) G(1)=1.D0-0.5D0*DABS(X(1))**0.5D0*X(7)/
     /    (X(3)*X(6)**2)-0.7D0
     /     *X(1)**3*X(2)*X(6)*DABS(X(7))**0.5D0/X(3)**2
     /     -0.2D0*X(3)*DABS(X(6))**(2.D0/3.D0)*DABS(X(7))**0.25D0
     /     /(X(2)*DABS(X(4))**0.5D0) 
      IF (INDEX1(2)) G(2)=1.D0-1.3D0*X(2)*X(6)/(DABS(X(1))**    
     /     0.5D0*X(3)*X(5))  
     /     -0.8D0*X(3)*X(6)**2/(X(4)*X(5))-3.1D0*DABS(X(2))**0.5D0*  
     /      DABS(X(6))**(1.D0/3.D0)/(X(1)*X(4)**2*X(5))     
      IF (INDEX1(3)) G(3)=1.D0-2.D0*X(1)*X(5)*DABS(X(7))**(1.D0/3.D0)
     /   /(DABS(X(3))**1.5D0*X(6))-0.1D0*X(2)*X(5)/(DABS(X(3)*X(7))
     /   **0.5D0*X(6))-X(2)*DABS(X(3))**0.5D0*X(5)/X(1)
     /    -0.65D0*X(3)*X(5)*X(7)/(X(2)**2*X(6))       
      IF (INDEX1(4)) G(4)=1.D0-0.2D0*X(2)*DABS(X(5))**0.5D0
     /     *DABS(X(7))**(1.D0/3.D0)/(X(1)**2*X(4))
     /    -0.3D0*DABS(X(1))**0.5D0*X(2)**2*X(3)*DABS(X(4))
     /     **(1.D0/3.D0)*DABS(X(7))**0.25D0/DABS(X(5))**(2.D0/3.D0)
     /     -0.4D0*X(3)*X(5)*DABS(X(7))**0.75D0/(X(1)**3*X(2)**2)
     /     -0.5D0*X(4)*DABS(X(7))**0.5D0/X(3)**2
      IF (INDEX1(5)) G(5)=10.D0*X(1)*X(4)**2*DABS(X(7))**A(M)
     /    /(X(2)*X(6)**3)+15.D0*X(3)*X(4)/(X(1)*X(2)**2*X(5)
     /    *DABS(X(7))**0.5D0)+20.D0*X(2)*X(6)/
     /    (X(1)**2*X(4)*X(5)**2)+25.D0*X(1)**2*X(2)**2
     /    *DABS(X(5))**0.5D0*X(7)/(X(3)*X(6)**2)-100.D0       
      IF (INDEX1(6)) G(6)=-(10.D0*X(1)*X(4)**2*DABS(X(7))**A(M)
     /     /(X(2)*X(6)**3)+15.D0*X(3)*X(4)/(X(1)*X(2)**2
     /     *X(5)*DABS(X(7))**0.5D0)+20.D0*X(2)*X(6)     
     /     /(X(1)**2*X(4)*X(5)**2)+25.D0*X(1)**2*X(2)**2
     /     *DABS(X(5))**0.5D0*X(7)/(X(3)*X(6)**2))+3.D+3       
      RETURN    
16    DO I=1,6
         G(I)=0.0D0
      ENDDO
      RETURN         
5     IF(.NOT.INDEX2(1)) GOTO 7 
      V1=DABS(X(1))**0.5D0      
      V2=X(1)**3
      V4=X(3)**2
      V5=V4**2  
      V6=DABS(X(4))**0.5D0      
      V7=X(6)**2
      V8=DABS(X(6))**(2.D0/3.D0)
      V9=DABS(X(7))**0.5D0      
      V10=DABS(X(7))**0.25D0    
      GG(1,1)=-0.25D0*X(7)/(V1*X(3)*V7)-2.1D0*X(1)**2*X(2)*X(6)*V9/V4
      GG(1,2)=-0.7D0*V2*X(6)*V9/V4+0.2D0*X(3)*V8*V10/(X(2)**2*V6)    
      GG(1,3)=0.5D0*V1*X(7)/(V4*V7)+1.4D0*V2*X(2)*X(6)*V9/(X(3)*V4)
     /      -0.2D0*V8*V10/(X(2)*V6)      
      GG(1,4)=0.1D0*X(3)*V8*V10/(X(2)*X(4)*V6)  
      GG(1,6)=V1*X(7)/(X(3)*V7*X(6))-0.7D0*V2*X(2)*V9/V4-0.4D0
     /     /3.D0*X(3)*V10/(X(2)*V6*DABS(X(6))**(1.D0/3.D0))
      GG(1,7)=-0.5D0*V1/(X(3)*V7)-0.35D0*V2*X(2)*X(6)/(V4*V9)
     /       -0.05D0*X(3)*V8/(X(2)*V6*V9*V10)      
7     IF (.NOT.INDEX2(2)) GOTO 8
      V11=DABS(X(1))**0.5D0     
      V12=DABS(X(2))**0.5D0     
      V13=X(4)**2       
      V14=X(5)**2       
      V15=DABS(X(6))**(1.D0/3.D0)       
      V16=X(6)**2       
      GG(2,1)=0.65D0*X(2)*X(6)/(X(1)*V11*X(3)*X(5))+3.1D0*V12*V15/
     /     (X(1)**2*V13*X(5))       
      GG(2,2)=-1.3D0*X(6)/(V11*X(3)*X(5))-1.55D0*V15/(X(1)*     
     /     V12*V13*X(5))     
      GG(2,3)=1.3D0*X(2)*X(6)/(V11*X(3)**2*X(5))-0.8D0*V16/(X(4)*X(5))  
      GG(2,4)=0.8D0*X(3)*V16/(V13*X(5))+6.2D0*V12*V15/(X(1)     
     /     *V13*X(4)*X(5))   
      GG(2,5)=1.3D0*X(2)*X(6)/(V11*X(3)*V14)+0.8D0*X(3)*V16     
     /           /(X(4)*V14)+3.1D0*V12*V15/(X(1)*V13*V14)   
      GG(2,6)=-1.3D0*X(2)/(V11*X(3)*X(5))-1.6D0*X(3)*X(6)/(X(4)*X(5))-  
     /        3.1D0/3.D0*V12/(X(1)*V13*X(5)*V15**2)     
8     IF(.NOT.INDEX2(3)) GOTO 9 
      V17=X(2)**2       
      V18=DABS(X(3))**0.5D0     
      V19=V18*X(3)      
      V20=X(6)**2       
      V21=DABS(X(7))**(1.D0/3.D0)       
      V22=DABS(X(7))**0.5D0     
      GG(3,1)=-2.D0*X(5)*V21/(V19*X(6))+X(2)*V18*X(5)/X(1)**2      
      GG(3,2)=-V18*X(5)/X(1)+1.3D0*X(3)*X(5)*X(7)/(V17*X(2)*X(6))
     /       -0.1D0*X(5)/(V18*V22*X(6))       
      GG(3,3)=3.D0*X(1)*X(5)*V21/(X(3)*V19*X(6))+0.05D0*X(2)*X(5)
     /     /(V19*X(6)*V22)-0.5D0*X(2)*X(5)/(X(1)*V18)
     /     -0.65D0*X(5)*X(7)/(V17*X(6))    
      GG(3,5)=-2.D0*X(1)*V21/(V19*X(6))-0.1D0*X(2)/(V18*X(6)*V22)
     /     -X(2)*V18/X(1)-0.65D0*X(3)*X(7)/(V17*X(6))  
      GG(3,6)=2.D0*X(1)*X(5)*V21/(V19*V20)+0.1D0*X(2)*X(5)/     
     /      (V18*V20*V22)+0.65D0*X(3)*X(5)*X(7)/(V17*V20)   
      GG(3,7)=-2.D0/3.D0*X(1)*X(5)/(V19*X(6)*V21**2)+0.05D0*X(2)*X(5)
     /     /(V18*X(6)*V22*X(7))-0.65D0*X(3)*X(5)/(V17*X(6))   
9     IF (.NOT.INDEX2(4)) GOTO 10       
      V23=DABS(X(1))**0.5D0     
      V24=X(1)**2       
      V25=V24*X(1)      
      V26=X(2)**2       
      V27=X(3)**2       
      V28=DABS(X(4))**(1.D0/3.D0)       
      V29=DABS(X(5))**(2.D0/3.D0)       
      V30=DABS(X(5))**0.5D0     
      V31=DABS(X(7))**0.25D0    
      V32=V31**2
      V33=V31*V32       
      V34=DABS(X(7))**(1.D0/3.D0)       
      GG(4,1)=0.4D0*X(2)*V30*V34/(V25*X(4))-0.15D0*V26*X(3)*V28*V31/ 
     /     (V23*V29)+1.2D0*X(3)*X(5)*V33/(V24**2*V26)
      GG(4,2)=-0.2D0*V30*V34/(V24*X(4))-0.6D0*V23*X(2)*X(3)*V28*V31/V29
     /     +0.8D0*X(3)*X(5)*V33/(V25*V26*X(2))       
      GG(4,3)=-0.3D0*V23*V26*V28*V31/V29-0.4D0*X(5)*V33/(V25*V26)
     /      +X(4)*V32/(V27*X(3))     
      GG(4,4)=0.2D0*X(2)*V30*V34/(V24*X(4)**2)-0.1D0*V23*V26*X(3)*V31
     /      /(V28**2*V29)-0.5D0*V32/V27   
      GG(4,5)=-0.1D0*X(2)*V34/(V24*X(4)*V30)+0.2D0*V23*V26*     
     /       X(3)*V28*V31/(X(5)*V29)-0.4D0*X(3)*V33/(V25*V26)  
      GG(4,7)=-0.2D0/3.D0*X(2)*V30/(V24*X(4)*V34**2)-0.075D0*   
     /       V23*V26*X(3)*V28/(V29*V33)-0.3D0*X(3)*X(5)/(V25*V26*V31)
     /       -0.25D0*X(4)/(V27*V32) 
10    IF (.NOT.INDEX2(5).AND..NOT.INDEX2(6)) GOTO 12    
      V35=10.D0*X(4)**2 
      V36=DABS(X(7))**A(M)      
      V37=X(2)*X(6)**3  
      V38=15.D0*X(3)*X(4)       
      V39=X(1)*X(2)**2*X(5)*DABS(X(7))**0.5D0   
      V40=20.D0*X(2)*X(6)       
      V41=X(1)**2*X(4)*X(5)**2  
      V42=25.D0*X(1)*X(2)*DABS(X(5))**0.5D0*X(7)
      V43=X(3)*X(6)**2  
      V44=12.5D0*X(1)**2*X(2)**2*X(7)   
      V45=DABS(X(5))**0.5D0     
      GV(1)=V35*V36/V37-V38/(X(1)*V39)-2.D0*V40/(X(1)*V41)+2.D0*X(2) 
     /     *V42/V43  
      GV(2)=-V35*X(1)*V36/(X(2)*V37)-2.D0*V38/(X(2)*V39)+20.D0*X(6)     
     /    /V41+2.D0*X(1)*V42/V43    
      GV(3)=15.D0*X(4)/V39-X(1)*X(2)*V42/(X(3)*V43)     
      GV(4)=20.D0*X(1)*X(4)*V36/V37+15.D0*X(3)/V39-V40/(X(4)*V41)    
      GV(5)=-V38/(X(5)*V39)-2.D0*V40/(X(5)*V41)+V44/(V43*V45)      
      GV(6)=-3.D0*V35*X(1)*V36/(X(6)*V37)+20.D0*X(2)/V41-4.D0   
     /      *V44*V45/(X(6)*V43)     
      GV(7)=A(M)*V35*X(1)*DABS(X(7))**(A(M)-1.D0)/V37-0.5D0*    
     /         V38/(V39*X(7))+V42*X(1)*X(2)/(X(7)*V43) 
      IF (.NOT.INDEX2(5)) GOTO 11       
      DO 20 I=1,7       
20    GG(5,I)=GV(I)     
11    IF (.NOT.INDEX2(6)) GOTO 12       
      DO 30 I=1,7       
30    GG(6,I)=-GV(I)    
12    RETURN    
      END       
