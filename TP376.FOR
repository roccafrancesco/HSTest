      SUBROUTINE TP376(MODE)
      IMPLICIT DOUBLEPRECISION (A-H,O-Z)  
      INTEGER    MODE,NMAX,MMAX,N,NILI,NINL,NELI,NENL,NEX   
      DOUBLEPRECISION X,G,GF,GG,FX,XL,XU,FEX,XEX 
      LOGICAL    INDEX1,INDEX2,LXL,LXU,LEX    
      PARAMETER (NMAX=101, MMAX=50)
      COMMON     /L1/  N,NILI,NINL,NELI,NENL 
     /           /L2/  X(NMAX)                              
     /           /L3/  G(MMAX)           
     /           /L4/  GF(NMAX)          
     /           /L5/  GG(MMAX,NMAX)        
     /           /L6/  FX
     /           /L9/  INDEX1(MMAX)     
     /           /L10/ INDEX2(MMAX)
     /           /L11/ LXL(NMAX)       
     /           /L12/ LXU(NMAX)    
     /           /L13/ XL(NMAX)     
     /           /L14/ XU(NMAX)    
     /           /L15/ F(200)    
     /           /L16/ DF(200,200)    
     /           /L20/ LEX,NEX,FEX,XEX(NMAX) 
      DOUBLEPRECISION F,DF
      INTEGER I
      GOTO(1,2,3,4,5),MODE
    1 N=10
      NILI=0
      NINL=14
      NELI=1
      NENL=0
      X(1)=1.0D-0
      X(2)=0.5D-2
      X(3)=0.81D-2
      X(4)=1.D+2
      X(5)=0.17D-2
      X(6)=0.13D-2
      X(7)=0.27D-2
      X(8)=0.2D-2
      X(9)=0.15
      X(10)=0.105
      DO 6 I=1,10
      LXU(I)=.TRUE.
    6 LXL(I)=.TRUE.
      XL(1)=0.D+0
      XL(2)=0.D+0	
      XL(3)=0.5D-4
      XL(4)=0.1D+2
      DO 7 I=5,10
    7 XL(I)=0.1D-2
      XU(1)=0.1D+2
      XU(2)=0.1D+0
      XU(3)=0.81D-2
      XU(4)=0.1D+4
      XU(5)=0.17D-2
      XU(6)=0.13D-2
      XU(7)=0.27D-2
      XU(8)=0.2D-2
      XU(9)=0.1D+1
      XU(10)=0.1D+1
      GG(1,1)=0.1D+1
      GG(1,2)=0.D+0
      DO 9 I=5,10
    9 GG(1,I)=0.D+0
      GG(2,1)=0.1D+1
      GG(2,2)=0.D+0
      GG(2,3)=0.D+0
      DO 10 I=6,8
   10 GG(2,I)=0.D+0
      GG(2,10)=0.D+0
      GG(3,1)=0.1D+1
      GG(3,2)=0.D+0
      GG(3,3)=0.D+0
      GG(3,5)=0.D+0
      DO 11 I=7,9
   11 GG(3,I)=0.D+0
      GG(4,1)=0.1D+1
      GG(4,2)=0.D+0
      GG(4,3)=0.D+0
      GG(4,5)=0.D+0
      GG(4,6)=0.D+0
      DO 12 I=8,10
   12 GG(4,I)=0.D+0
      GG(5,1)=0.1D+1
      GG(5,2)=0.D+0
      GG(5,3)=0.D+0
      DO 13 I=5,7
   13 GG(5,I)=0.D+0
      GG(5,9)=0.D+0
      GG(5,10)=0.D+0
      GG(6,1)=0.D+0	
      GG(6,2)=0.1D+5
      GG(6,3)=0.D+0
      DO 14 I=6,8
   14 GG(6,I)=0.D+0
      GG(6,10)=0.D+0
      GG(7,1)=0.D+0
      GG(7,2)=0.1D+5
      GG(7,3)=0.D+0
      GG(7,5)=0.D+0
      DO 15 I=7,9
   15 GG(7,I)=0.D+0
      GG(8,1)=0.D+0
      GG(8,2)=0.1D+5
      GG(8,3)=0.D+0
      GG(8,5)=0.D+0
      GG(8,6)=0.D+0
      DO 16 I=8,10
   16 GG(8,I)=0.D+0
      GG(9,1)=0.D+0
      GG(9,2)=0.1D+5
      GG(9,3)=0.D+0
      DO 17 I=5,7
   17 GG(9,I)=0.D+0
      GG(9,9)=0.D+0
      GG(9,10)=0.D+0
      GG(10,1)=0.D+0
      GG(10,2)=0.1D+5
      DO 18 I=5,10
   18 GG(10,I)=0.D+0
      GG(11,1)=0.D+0
      GG(11,2)=0.1D+5
      DO 19 I=5,10
   19 GG(11,I)=0.D+0
      GG(12,1)=0.D+0
      GG(12,2)=0.1D+5
      DO 20 I=5,10
   20 GG(12,I)=0.D+0
      GG(13,1)=0.D+0
      GG(13,2)=0.1D+5
      DO 21 I=5,10
   21 GG(13,I)=0.D+0
      GG(14,1)=0.D+0
      GG(14,2)=0.D+0
      GG(14,7)=0.D+0
      GG(14,9)=0.D+0
      GG(14,10)=0.0D+0
      DO 8 I=1,8
    8 GG(15,I)=0.D+0
      GG(15,9)=0.1D+1
      GG(15,10)=0.1D+1
      LEX=.FALSE.
      NEX=1
      FEX=-0.44300879D+04
      XEX(1)=.14727222
      XEX(2)=0.1
      XEX(3)=0.81D-2
      XEX(4)=0.62871731D+03
      XEX(5)=0.17D-2
      XEX(6)=0.11816143D-02
      XEX(7)=0.27D-2
      XEX(8)=0.135D-02
      XEX(9)=0.15740741
      XEX(10)=0.97592593D-01
      DO 45 I=3,10
   45 GF(I)=0.0D+0
      RETURN
    2 FX=0.2D+5*(0.15D+0*X(1)+0.14D+2*X(2)-0.6D-1)/(0.2D-2+X(1)+0.6D+2
     /    *X(2))
      FX=-FX
      RETURN
    3 CONTINUE
      GF(1)=((0.15D+0*(0.2D-2+X(1)+0.6D+2*X(2))-(0.15D+0*X(1)+0.14D+2
     /    *X(2)-0.6D-1))*0.2D+5)/(0.2D-2+X(1)+0.6D+2*X(2))**0.2D+1
      GF(2)=((0.14D+2*(0.2D-2+X(1)+0.6D+2*X(2))-((0.15D+0*X(1)+0.14D+2
     /    *X(2)-0.6D-1)*0.6D+2))*0.2D+5)/(0.2D-2+X(1)
     /      +0.6D+2*X(2))**0.2D+1
      GF(1)=-GF(1)
      GF(2)=-GF(2)
      RETURN
    4 CONTINUE
      DO I=1,10
        IF (X(I).LT.XL(I)) X(I)=XL(I)
      ENDDO
      IF (INDEX1(1)) G(1)=X(1)-0.75D+0/X(3)/X(4)
      IF (INDEX1(2)) G(2)=X(1)-X(9)/X(5)/X(4)
      IF (INDEX1(3)) G(3)=X(1)-X(10)/X(6)/X(4)-0.1D+2/X(4)
      IF (INDEX1(4)) G(4)=X(1)-0.19D+0/X(7)/X(4)-0.1D+2/X(4)
      IF (INDEX1(5)) G(5)=X(1)-0.125D+0/X(8)/X(4)
      IF (INDEX1(6)) G(6)=0.1D+5*X(2)-0.131D-2*X(9)*X(5)**0.666D+0
     1 *X(4)**1.5D+0
      IF (INDEX1(7)) G(7)=0.1D+5*X(2)-0.1038D-2*X(10)*X(6)**0.16D+1
     1 *X(4)**3
      IF (INDEX1(8)) G(8)=0.1D+5*X(2)-0.223D-3*X(7)**0.666D+0
     1 *X(4)**1.5D+0
      IF (INDEX1(9)) G(9)=0.1D+5*X(2)-0.76D-4*X(8)**3.55D+0
     1 *X(4)**5.66D+0
      IF (INDEX1(10)) G(10)=0.1D+5*X(2)-0.698D-3*X(3)**1.2D+0
     1 *X(4)**2
      IF (INDEX1(11)) G(11)=0.1D+5*X(2)-0.5D-4*X(3)**1.6D+0
     1 *X(4)**3.D+0
      IF (INDEX1(12)) G(12)=0.1D+5*X(2)-0.654D-5*X(3)**2.42D+0
     1 *X(4)**4.17D+0
      IF (INDEX1(13)) G(13)=0.1D+5*X(2)-0.257D-3*X(3)**0.666D+0
     1 *X(4)**1.5D+0
      IF (INDEX1(14)) G(14)=0.3D+2-0.2003D+1*X(5)*X(4)-0.1885D+1*X(6)
     1 *X(4)-0.184D+0*X(8)*X(4)-0.2D+1*X(3)**0.803D+0*X(4)
      IF (INDEX1(15)) G(15)=X(9)+X(10)-0.255D+0
      RETURN
    5 IF (.NOT.INDEX2(1)) GOTO 50
      GG(1,3)=0.75D+0/X(3)**0.2D+1/X(4)
      GG(1,4)=0.75D+0/X(3)/X(4)**0.2D+1
   50 IF (.NOT.INDEX2(2)) GOTO 51
      GG(2,4)=X(9)/X(5)/X(4)**0.2D+1
      GG(2,5)=X(9)/X(5)**0.2D+1/X(4)
      GG(2,9)=-0.1D+1/X(5)/X(4)
   51 IF (.NOT.INDEX2(3)) GOTO 52
      GG(3,4)=X(10)/X(6)/X(4)**0.2D+1+0.1D+2/X(4)**0.2D+1
      GG(3,6)=X(10)/X(6)**0.2D+1/X(4)
      GG(3,10)=-0.1D+1/X(6)/X(4)
   52 IF (.NOT.INDEX2(4)) GOTO 53
      GG(4,4)=0.19D+0/X(7)/X(4)**0.2D+1+0.1D+2/X(4)**0.2D+1
      GG(4,7)=0.19D+0/X(7)**0.2D+1/X(4)
   53 IF (.NOT.INDEX2(5)) GOTO 54
      GG(5,4)=0.125D+0/X(8)/X(4)**0.2D+1
      GG(5,8)=0.125D+0/X(8)**0.2D+1/X(4)
   54 IF (.NOT.INDEX2(6)) GOTO 55
      GG(6,4)=-0.15D+1*0.131D-2*X(9)*X(5)**0.666D+0*X(4)**0.5D+0
      GG(6,5)=-0.666D+0*0.131D-2*X(9)/X(5)**0.334D+0*X(4)**0.15D+1
      GG(6,9)=-0.131D-2*X(5)**0.666D+0*X(4)**0.15D+1
   55 IF (.NOT.INDEX2(7)) GOTO 56
      GG(7,4)=-0.3D+1*0.1038D-2*X(10)*X(6)**0.16D+1*X(4)**0.2D+1
      GG(7,6)=-0.16D+1*0.1038D-2*X(10)*X(6)**0.6D+0*X(4)**0.3D+1
      GG(7,10)=-0.1038D-2*X(6)**0.16D+1*X(4)**0.3D+1
   56 IF (.NOT.INDEX2(8)) GOTO 57
      GG(8,4)=-0.15D+1*0.223D-3*X(7)**0.666D+0*X(4)**0.5D+0
      GG(8,7)=-0.666D+0*0.223D-3/X(7)**0.334D+0*X(4)**0.15D+1
   57 IF (.NOT.INDEX2(9)) GOTO 58
      GG(9,4)=-0.566D+1*0.76D-4*X(8)**0.355D+1*X(4)**0.466D+1
      GG(9,8)=-0.355D+1*0.76D-4*X(8)**0.255D+1*X(4)**0.566D+1
   58 IF (.NOT.INDEX2(10)) GOTO 59
      GG(10,3)=-0.12D+1*0.698D-3*X(3)**0.2D+0*X(4)**0.2D+1
      GG(10,4)=-0.2D+1*0.698D-3*X(3)**0.12D+1*X(4)
   59 IF (.NOT.INDEX2(11)) GOTO 60
      GG(11,3)=-0.16D+1*0.5D-4*X(3)**0.6D+0*X(4)**0.3D+1
      GG(11,4)=-0.3D+1*0.5D-4*X(3)**0.16D+1*X(4)**0.2D+1
   60 IF (.NOT.INDEX2(12)) GOTO 61
      GG(12,3)=-0.242D+1*0.654D-5*X(3)**0.142D+1*X(4)**0.417D+1
      GG(12,4)=-0.417D+1*0.654D-5*X(3)**0.242D+1*X(4)**0.317D+1
   61 IF (.NOT.INDEX2(13)) GOTO 62
      GG(13,3)=-0.666D+0*0.257D-3/X(3)**0.334D+0*X(4)**0.15D+1
      GG(13,4)=-0.15D+1*0.257D-3*X(3)**0.666D+0*X(4)**0.5D+0
   62 IF (.NOT.INDEX2(14)) GOTO 63
      GG(14,3)=-0.803D+0*0.2D+1/X(3)**0.197D+0*X(4)
      GG(14,4)=-0.2003D+1*X(5)-0.1885D+1*X(6)-0.184D+0*X(8)
     1-0.2D+1*X(3)**0.803D+0
      GG(14,5)=-0.2003D+1*X(4)
      GG(14,6)=-0.1885D+1*X(4)
      GG(14,8)=-0.184D+0*X(4)
   63 RETURN
      END	
